# 参考文章  

   DLL中调用约定和名称修饰 (一) https://blog.csdn.net/rivershan/article/details/15785

# DLL中的调用约定  

## 调用约定的定义  

<span style='color:black;font-size:18px;font-family:微软雅黑;'>
        函数的调用约定，顾名思义就是对函数调用的一个约束和规定(规范)，描述了函数参数是怎么传递和由谁清除堆栈的。

​        它决定以下内容：
​        (1)函数参数的压栈顺序，
​		(2)由调用者还是被调用者把参数弹出栈，
   	 (3)以及产生函数修饰名的方法。不同的语言定义了不同的调用约定。

​        在C++中，为了允许操作符重载和函数重载，C++编译器往往按照某种规则改写每一个入口点的符号名，以便允许同一个名字（具有不同的参数类型或者是不同的作用域）有多个用法，而不会打破现有的基于C的链接器。这项技术通常被称为名称改编（Name Mangling）或者名称修饰（Name Decoration）。
​        许多C++编译器厂商选择了自己的名称修饰方案。因此，为了使其它语言编写的模块（如Visual Basic应用程序、Pascal或Fortran的应用程序等）可以调用C/C++编写的DLL的函数，必须使用正确的调用约定来导出函数，并且不要让编译器对要导出的函数进行任何名称修饰。据说，C++标准并没有规定Name-Mangling的方案，所以不同编译器使用的是不同的，例如：Borland C++跟Mircrosoft C++就不同，而且可能不同版本的编译器他们的Name-Mangling规则也是不同的。这样的话，不同编译器编译出来的目标文件.obj 是不通用的，因为同一个函数，使用不同的Name-Mangling在obj文件中就会有不同的名字。如果DLL里的函数重命名规则跟DLL的使用者采用的重命名规则不一致，那就会找不到这个函数。
​          C标准规定了C语言Name-Mangling的规范（林锐的书有这样说过）。这样就使得，任何一个支持c语言的编译器，它编译出来的obj文件可以共享，链接成可执行文件。这是一种标准，如果DLL跟其使用者都采用这种约定，那么就可以解决函数重命名规则不一致导致的错误。









</span>